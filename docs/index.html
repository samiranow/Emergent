<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConfigForge V2Ray Frontend</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: Arial, sans-serif;
        }
        .container {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            max-width: 700px;
        }
        h1 {
            text-align: center;
            margin-bottom: 1.5rem;
            color: #333;
        }
        .btn-primary {
            width: 100%;
            transition: background-color 0.3s;
        }
        #configs-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
        }
        ul {
            list-style-type: none;
            padding: 0;
        }
        li {
            padding: 0.5rem;
            border-bottom: 1px solid #eee;
        }
        .config-file-section {
            margin-bottom: 1rem;
        }
        .config-file-section h3 {
            font-size: 1.2rem;
            color: #007bff;
            margin-bottom: 0.5rem;
        }
        [dir="rtl"] {
            text-align: right;
        }
        .error-message {
            color: #dc3545;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="title">VPN Config Selector</h1>
        <select id="language-select" class="form-select mb-3">
            <option value="en">English</option>
            <option value="fa">ÙØ§Ø±Ø³ÛŒ</option>
            <option value="zh">ä¸­æ–‡ (ç®€ä½“)</option>
            <option value="es">EspaÃ±ol</option>
            <option value="fr">FranÃ§ais</option>
            <option value="de">Deutsch</option>
            <option value="ru">Ğ ÑƒÑÑĞºĞ¸Ğ¹</option>
            <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
            <option value="ja">æ—¥æœ¬èª</option>
            <option value="ko">í•œêµ­ì–´</option>
            <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
            <option value="pt">PortuguÃªs</option>
            <option value="it">Italiano</option>
            <option value="tr">TÃ¼rkÃ§e</option>
            <option value="nl">Nederlands</option>
        </select>
        <select id="country-select" class="form-select mb-3">
            <option value="">Select Country</option>
            <option value="United States">ğŸ‡ºğŸ‡¸ United States</option>
            <option value="Iran">ğŸ‡®ğŸ‡· Iran</option>
            <option value="China">ğŸ‡¨ğŸ‡³ China</option>
            <option value="United Kingdom">ğŸ‡¬ğŸ‡§ United Kingdom</option>
            <option value="Germany">ğŸ‡©ğŸ‡ª Germany</option>
            <option value="France">ğŸ‡«ğŸ‡· France</option>
            <option value="Japan">ğŸ‡¯ğŸ‡µ Japan</option>
            <option value="Canada">ğŸ‡¨ğŸ‡¦ Canada</option>
            <option value="Russia">ğŸ‡·ğŸ‡º Russia</option>
            <option value="India">ğŸ‡®ğŸ‡³ India</option>
            <option value="Brazil">ğŸ‡§ğŸ‡· Brazil</option>
            <option value="Australia">ğŸ‡¦ğŸ‡º Australia</option>
            <option value="Turkey">ğŸ‡¹ğŸ‡· Turkey</option>
            <option value="Netherlands">ğŸ‡³ğŸ‡± Netherlands</option>
            <option value="Spain">ğŸ‡ªğŸ‡¸ Spain</option>
        </select>
        <button id="get-configs" class="btn btn-primary mb-3">Get Configs</button>
        <div id="configs-list"></div>
        <button id="copy-all" class="btn btn-success mt-3" style="display: none; width: 100%;">Copy All to Clipboard</button>
        <button id="download-sub" class="btn btn-info mt-3" style="display: none; width: 100%;">Download Configs File</button>
    </div>

    <script>
        const translations = {
            en: {
                title: 'VPN Config Selector',
                getBtns: 'Get Configs',
                copyAll: 'Copy All to Clipboard',
                download: 'Download Configs File',
                noConfigs: 'No configs found for this country.',
                configsFound: 'Found {count} configs in {file}.',
                selectCountry: 'Select Country',
                error: 'Error fetching configs. Please try again later.'
            },
            fa: {
                title: 'Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†Ù†Ø¯Ù‡ Ú©Ø§Ù†ÙÛŒÚ¯ VPN',
                getBtns: 'Ø¯Ø±ÛŒØ§ÙØª Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§',
                copyAll: 'Ú©Ù¾ÛŒ Ù‡Ù…Ù‡ Ø¨Ù‡ Ú©Ù„ÛŒÙ¾â€ŒØ¨ÙˆØ±Ø¯',
                download: 'Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§',
                noConfigs: 'Ù‡ÛŒÚ† Ú©Ø§Ù†ÙÛŒÚ¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ú©Ø´ÙˆØ± ÛŒØ§ÙØª Ù†Ø´Ø¯.',
                configsFound: '{count} Ú©Ø§Ù†ÙÛŒÚ¯ Ø¯Ø± {file} ÛŒØ§ÙØª Ø´Ø¯.',
                selectCountry: 'Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø´ÙˆØ±',
                error: 'Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ú©Ø§Ù†ÙÛŒÚ¯â€ŒÙ‡Ø§. Ù„Ø·ÙØ§Ù‹ Ø¨Ø¹Ø¯Ø§Ù‹ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.'
            },
            zh: {
                title: 'VPN é…ç½®é€‰æ‹©å™¨',
                getBtns: 'è·å–é…ç½®',
                copyAll: 'å¤åˆ¶æ‰€æœ‰åˆ°å‰ªè´´æ¿',
                download: 'ä¸‹è½½é…ç½®æ–‡ä»¶',
                noConfigs: 'æœªæ‰¾åˆ°æ­¤å›½å®¶çš„é…ç½®ã€‚',
                configsFound: 'åœ¨ {file} ä¸­æ‰¾åˆ° {count} ä¸ªé…ç½®ã€‚',
                selectCountry: 'é€‰æ‹©å›½å®¶',
                error: 'è·å–é…ç½®æ—¶å‡ºé”™ã€‚è¯·ç¨åå†è¯•ã€‚'
            },
            es: {
                title: 'Selector de ConfiguraciÃ³n VPN',
                getBtns: 'Obtener Configuraciones',
                copyAll: 'Copiar Todo al Portapapeles',
                download: 'Descargar Archivo de Configuraciones',
                noConfigs: 'No se encontraron configuraciones para este paÃ­s.',
                configsFound: 'Encontradas {count} configuraciones en {file}.',
                selectCountry: 'Seleccionar PaÃ­s',
                error: 'Error al obtener configuraciones. Intenta de nuevo mÃ¡s tarde.'
            },
            fr: {
                title: 'SÃ©lecteur de Configuration VPN',
                getBtns: 'Obtenir les Configurations',
                copyAll: 'Copier Tout dans le Presse-papiers',
                download: 'TÃ©lÃ©charger le Fichier de Configurations',
                noConfigs: 'Aucune configuration trouvÃ©e pour ce pays.',
                configsFound: '{count} configurations trouvÃ©es dans {file}.',
                selectCountry: 'SÃ©lectionner le Pays',
                error: 'Erreur lors de la rÃ©cupÃ©ration des configurations. RÃ©essayez plus tard.'
            },
            de: {
                title: 'VPN-Konfigurationsauswahl',
                getBtns: 'Konfigurationen Abrufen',
                copyAll: 'Alle in die Zwischenablage Kopieren',
                download: 'Konfigurationsdatei Herunterladen',
                noConfigs: 'Keine Konfigurationen fÃ¼r dieses Land gefunden.',
                configsFound: '{count} Konfigurationen in {file} gefunden.',
                selectCountry: 'Land AuswÃ¤hlen',
                error: 'Fehler beim Abrufen der Konfigurationen. Bitte spÃ¤ter erneut versuchen.'
            },
            ru: {
                title: 'Ğ¡ĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹ VPN',
                getBtns: 'ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸',
                copyAll: 'Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ’ÑĞµ Ğ² Ğ‘ÑƒÑ„ĞµÑ€ ĞĞ±Ğ¼ĞµĞ½Ğ°',
                download: 'Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¤Ğ°Ğ¹Ğ» ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹',
                noConfigs: 'ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ ÑÑ‚Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ°Ğ½Ñ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹.',
                configsFound: 'ĞĞ°Ğ¹Ğ´ĞµĞ½Ğ¾ {count} ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹ Ğ² {file}.',
                selectCountry: 'Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¡Ñ‚Ñ€Ğ°Ğ½Ñƒ',
                error: 'ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¹. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ Ğ¿Ğ¾Ğ·Ğ¶Ğµ.'
            },
            ar: {
                title: 'Ù…Ø­Ø¯Ø¯ ØªÙƒÙˆÙŠÙ† VPN',
                getBtns: 'Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙƒÙˆÙŠÙ†Ø§Øª',
                copyAll: 'Ù†Ø³Ø® Ø§Ù„ÙƒÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©',
                download: 'ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù Ø§Ù„ØªÙƒÙˆÙŠÙ†Ø§Øª',
                noConfigs: 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙƒÙˆÙŠÙ†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¨Ù„Ø¯.',
                configsFound: 'ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ {count} ØªÙƒÙˆÙŠÙ†Ø§Øª ÙÙŠ {file}.',
                selectCountry: 'Ø§Ø®ØªØ± Ø§Ù„Ø¨Ù„Ø¯',
                error: 'Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„ØªÙƒÙˆÙŠÙ†Ø§Øª. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ù‹Ø§.'
            },
            ja: {
                title: 'VPN è¨­å®šã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼',
                getBtns: 'è¨­å®šã‚’å–å¾—',
                copyAll: 'ã™ã¹ã¦ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼',
                download: 'è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰',
                noConfigs: 'ã“ã®å›½ã«å¯¾ã™ã‚‹è¨­å®šãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚',
                configsFound: '{file} ã§ {count} å€‹ã®è¨­å®šãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚',
                selectCountry: 'å›½ã‚’é¸æŠ',
                error: 'è¨­å®šã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å¾Œã§å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚'
            },
            ko: {
                title: 'VPN êµ¬ì„± ì„ íƒê¸°',
                getBtns: 'êµ¬ì„± ê°€ì ¸ì˜¤ê¸°',
                copyAll: 'ëª¨ë‘ í´ë¦½ë³´ë“œì— ë³µì‚¬',
                download: 'êµ¬ì„± íŒŒì¼ ë‹¤ìš´ë¡œë“œ',
                noConfigs: 'ì´ êµ­ê°€ì— ëŒ€í•œ êµ¬ì„±ì´ ì—†ìŠµë‹ˆë‹¤.',
                configsFound: '{file}ì—ì„œ {count} ê°œì˜ êµ¬ì„±ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤.',
                selectCountry: 'êµ­ê°€ ì„ íƒ',
                error: 'êµ¬ì„± ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜. ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•˜ì‹­ì‹œì˜¤.'
            },
            hi: {
                title: 'VPN à¤•à¥‰à¤¨à¥à¤«à¤¼à¤¿à¤— à¤šà¤¯à¤¨à¤•à¤°à¥à¤¤à¤¾',
                getBtns: 'à¤•à¥‰à¤¨à¥à¤«à¤¼à¤¿à¤— à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¥‡à¤‚',
                copyAll: 'à¤¸à¤­à¥€ à¤•à¥‹ à¤•à¥à¤²à¤¿à¤ªà¤¬à¥‹à¤°à¥à¤¡ à¤ªà¤° à¤•à¥‰à¤ªà¥€ à¤•à¤°à¥‡à¤‚',
                download: 'à¤•à¥‰à¤¨à¥à¤«à¤¼à¤¿à¤— à¤«à¤¼à¤¾à¤‡à¤² à¤¡à¤¾à¤‰à¤¨à¤²à¥‹à¤¡ à¤•à¤°à¥‡à¤‚',
                noConfigs: 'à¤‡à¤¸ à¤¦à¥‡à¤¶ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥‹à¤ˆ à¤•à¥‰à¤¨à¥à¤«à¤¼à¤¿à¤— à¤¨à¤¹à¥€à¤‚ à¤®à¤¿à¤²à¤¾à¥¤',
                configsFound: '{file} à¤®à¥‡à¤‚ {count} à¤•à¥‰à¤¨à¥à¤«à¤¼à¤¿à¤— à¤®à¤¿à¤²à¥‡à¥¤',
                selectCountry: 'à¤¦à¥‡à¤¶ à¤šà¥à¤¨à¥‡à¤‚',
                error: 'à¤•à¥‰à¤¨à¥à¤«à¤¼à¤¿à¤— à¤ªà¥à¤°à¤¾à¤ªà¥à¤¤ à¤•à¤°à¤¨à¥‡ à¤®à¥‡à¤‚ à¤¤à¥à¤°à¥à¤Ÿà¤¿à¥¤ à¤•à¥ƒà¤ªà¤¯à¤¾ à¤¬à¤¾à¤¦ à¤®à¥‡à¤‚ à¤ªà¥à¤¨à¤ƒ à¤ªà¥à¤°à¤¯à¤¾à¤¸ à¤•à¤°à¥‡à¤‚à¥¤'
            },
            pt: {
                title: 'Seletor de ConfiguraÃ§Ã£o VPN',
                getBtns: 'Obter ConfiguraÃ§Ãµes',
                copyAll: 'Copiar Tudo para a Ãrea de TransferÃªncia',
                download: 'Baixar Arquivo de ConfiguraÃ§Ãµes',
                noConfigs: 'Nenhuma configuraÃ§Ã£o encontrada para este paÃ­s.',
                configsFound: '{count} configuraÃ§Ãµes encontradas em {file}.',
                selectCountry: 'Selecionar PaÃ­s',
                error: 'Erro ao obter configuraÃ§Ãµes. Tente novamente mais tarde.'
            },
            it: {
                title: 'Selettore Configurazione VPN',
                getBtns: 'Ottieni Configurazioni',
                copyAll: 'Copia Tutto negli Appunti',
                download: 'Scarica File di Configurazioni',
                noConfigs: 'Nessuna configurazione trovata per questo paese.',
                configsFound: 'Trovate {count} configurazioni in {file}.',
                selectCountry: 'Seleziona Paese',
                error: 'Errore durante il recupero delle configurazioni. Riprova piÃ¹ tardi.'
            },
            tr: {
                title: 'VPN YapÄ±landÄ±rma SeÃ§ici',
                getBtns: 'YapÄ±landÄ±rmalarÄ± Al',
                copyAll: 'TÃ¼mÃ¼nÃ¼ Panoya Kopyala',
                download: 'YapÄ±landÄ±rma DosyasÄ±nÄ± Ä°ndir',
                noConfigs: 'Bu Ã¼lke iÃ§in yapÄ±landÄ±rma bulunamadÄ±.',
                configsFound: '{file} iÃ§inde {count} yapÄ±landÄ±rma bulundu.',
                selectCountry: 'Ãœlke SeÃ§',
                error: 'YapÄ±landÄ±rmalar alÄ±nÄ±rken hata oluÅŸtu. LÃ¼tfen daha sonra tekrar deneyin.'
            },
            nl: {
                title: 'VPN Config Selector',
                getBtns: 'Configs Ophalen',
                copyAll: 'Alles KopiÃ«ren naar Klembord',
                download: 'Configs Bestand Downloaden',
                noConfigs: 'Geen configs gevonden voor dit land.',
                configsFound: '{count} configs gevonden in {file}.',
                selectCountry: 'Selecteer Land',
                error: 'Fout bij het ophalen van configs. Probeer het later opnieuw.'
            }
        };

        let currentLang = navigator.language.substring(0, 2);
        if (!translations[currentLang]) currentLang = 'en';

        function updateLanguage(lang) {
            currentLang = lang;
            document.documentElement.lang = lang;
            const rtlLanguages = ['fa', 'ar'];
            document.documentElement.dir = rtlLanguages.includes(lang) ? 'rtl' : 'ltr';
            document.getElementById('title').textContent = translations[lang].title;
            document.getElementById('get-configs').textContent = translations[lang].getBtns;
            document.getElementById('copy-all').textContent = translations[lang].copyAll;
            document.getElementById('download-sub').textContent = translations[lang].download;
            document.getElementById('country-select').options[0].textContent = translations[lang].selectCountry;
        }

        updateLanguage(currentLang);
        document.getElementById('language-select').value = currentLang;

        document.getElementById('language-select').addEventListener('change', (e) => {
            updateLanguage(e.target.value);
        });

        const countryMap = {
            'United States': ['ğŸ‡ºğŸ‡¸', 'us', 'usa', 'united states', 'america', 'new york', 'los angeles', 'chicago'],
            'Iran': ['ğŸ‡®ğŸ‡·', 'ir', 'iran', 'tehran', 'Ø§ÛŒØ±Ø§Ù†', 'ØªÙ‡Ø±Ø§Ù†', 'persia'],
            'China': ['ğŸ‡¨ğŸ‡³', 'cn', 'china', 'beijing', 'shanghai', 'ä¸­å›½'],
            'United Kingdom': ['ğŸ‡¬ğŸ‡§', 'gb', 'uk', 'united kingdom', 'london', 'england'],
            'Germany': ['ğŸ‡©ğŸ‡ª', 'de', 'germany', 'berlin', 'frankfurt', 'deutschland'],
            'France': ['ğŸ‡«ğŸ‡·', 'fr', 'france', 'paris', 'marseille'],
            'Japan': ['ğŸ‡¯ğŸ‡µ', 'jp', 'japan', 'tokyo', 'osaka', 'æ—¥æœ¬'],
            'Canada': ['ğŸ‡¨ğŸ‡¦', 'ca', 'canada', 'toronto', 'vancouver'],
            'Russia': ['ğŸ‡·ğŸ‡º', 'ru', 'russia', 'moscow', 'saint petersburg', 'Ñ€Ğ¾ÑÑĞ¸Ñ'],
            'India': ['ğŸ‡®ğŸ‡³', 'in', 'india', 'mumbai', 'delhi', 'à¤­à¤¾à¤°à¤¤'],
            'Brazil': ['ğŸ‡§ğŸ‡·', 'br', 'brazil', 'sao paulo', 'rio de janeiro', 'brasil'],
            'Australia': ['ğŸ‡¦ğŸ‡º', 'au', 'australia', 'sydney', 'melbourne'],
            'Turkey': ['ğŸ‡¹ğŸ‡·', 'tr', 'turkey', 'istanbul', 'ankara', 'tÃ¼rkiye'],
            'Netherlands': ['ğŸ‡³ğŸ‡±', 'nl', 'netherlands', 'amsterdam', 'rotterdam'],
            'Spain': ['ğŸ‡ªğŸ‡¸', 'es', 'spain', 'madrid', 'barcelona', 'espaÃ±a']
        };

        function getRemark(line) {
            try {
                if (line.startsWith('vmess://')) {
                    const jsonStr = atob(line.substring(8));
                    const obj = JSON.parse(jsonStr);
                    return obj.ps || '';
                } else if (line.includes('#')) {
                    return decodeURIComponent(line.split('#')[1] || '');
                }
            } catch (e) {
                return '';
            }
            return '';
        }

        const configFiles = ['all.txt', 'light.txt', 'vless.txt', 'vmess.txt', 'shadowsocks.txt', 'trojan.txt', 'unknown.txt'];

        document.getElementById('get-configs').addEventListener('click', async () => {
            const country = document.getElementById('country-select').value;
            if (!country) {
                alert(translations[currentLang].selectCountry);
                return;
            }

            const listDiv = document.getElementById('configs-list');
            listDiv.innerHTML = '<p>Loading...</p>';
            const copyBtn = document.getElementById('copy-all');
            const downloadBtn = document.getElementById('download-sub');
            copyBtn.style.display = 'none';
            downloadBtn.style.display = 'none';

            let allConfigs = [];
            let hasContent = false;

            try {
                for (const file of configFiles) {
                    const url = `https://raw.githubusercontent.com/ShatakVPN/ConfigForge-V2Ray/main/configs/${country}/${file}`;
                    try {
                        const response = await fetch(url);
                        if (!response.ok) continue; // Skip if file doesn't exist
                        const text = await response.text();
                        const decoded = atob(text); // Decode base64
                        const lines = decoded.split('\n').filter(line => line.trim() !== '');

                        if (lines.length > 0) {
                            hasContent = true;
                            const section = document.createElement('div');
                            section.className = 'config-file-section';
                            section.innerHTML = `<h3>${file}</h3><p>${translations[currentLang].configsFound.replace('{count}', lines.length).replace('{file}', file)}</p>`;
                            const ul = document.createElement('ul');
                            lines.forEach(line => {
                                const remark = getRemark(line);
                                const li = document.createElement('li');
                                li.textContent = remark || 'Unknown';
                                ul.appendChild(li);
                                allConfigs.push(line);
                            });
                            section.appendChild(ul);
                            listDiv.appendChild(section);
                        }
                    } catch (e) {
                        console.warn(`Failed to fetch ${file}:`, e);
                        continue;
                    }
                }

                if (!hasContent) {
                    listDiv.innerHTML = `<p class="error-message">${translations[currentLang].noConfigs}</p>`;
                } else {
                    copyBtn.style.display = 'block';
                    downloadBtn.style.display = 'block';
                    copyBtn.onclick = () => {
                        navigator.clipboard.writeText(allConfigs.join('\n')).then(() => {
                            alert('Copied to clipboard! Paste into your V2Ray client.');
                        });
                    };
                    downloadBtn.onclick = () => {
                        const blob = new Blob([allConfigs.join('\n')], { type: 'text/plain' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `${country}_v2ray_configs.txt`;
                        a.click();
                        URL.revokeObjectURL(url);
                    };
                }
            } catch (err) {
                console.error(err);
                listDiv.innerHTML = `<p class="error-message">${translations[currentLang].error}</p>`;
            }
        });

        // Auto-detect user country
        fetch('https://ipapi.co/json/')
            .then(res => res.json())
            .then(data => {
                const countryName = data.country_name;
                const countrySelect = document.getElementById('country-select');
                if (countryName && countrySelect.querySelector(`option[value="${countryName}"]`)) {
                    countrySelect.value = countryName;
                }
            })
            .catch(() => {});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
